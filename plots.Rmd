---
title: "Applications CDDM"
author: "Manuel Villarreal"
date: "2022-09-29"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
load(file = "data/spaceship-tracking.Rdata")
```

Histogram of the predicted positions of the spaceship in radians by condition, units are given in radians.

```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=2}
layout(t(seq(1,4)))
par(mai = c(0.1,0.1,0.1,0.1),
    oma = c(1,0,0,0),
    xaxs = "i")
for(i in 1:4){
hist(as.vector(space[,"response",])[which(space[,"condition",]== i)],
     axes = FALSE, ann = FALSE, xlim = c(-2 * pi - 0.9, 2 * pi + 0.9))
  axis(1,at = c(0,pi/2,pi,3/2 * pi, 2*pi), 
       labels = c(0,expression(pi/2), expression(pi), expression(3*pi/2), 
                  expression(2*pi)),pos = c(0,0))
}
```

Histogram of the difference between predicted and observed position for the spaceship divided by condition, the units are given in radians.

```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=2}
layout(t(seq(1,4)))
par(mai = c(0.1,0.1,0.1,0.1),
    oma = c(1,0,0,0),
    xaxs = "i")
for(i in 1:4){
  hist(as.vector(space[,"response",])[which(space[,"condition",]== i)] -
         as.vector(space[,"position",])[which(space[,"condition",]== i)],
       axes = FALSE, ann = FALSE, xlim = c(-2 * pi - 0.9, 2 * pi + 0.9),
       breaks = 30)
  axis(1, at = c(-2*pi, -pi/2, 0, pi/2, 2*pi), 
       labels = c(expression(-2*pi), expression(-pi/2), 0, 
                  expression( pi/2), expression( 2*pi)),
       pos = c(0,0))
} 

```

Histogram of response times by condition.

```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=2}
layout(t(seq(1,4)))
par(mai = c(0.1,0.1,0.1,0.1),
    oma = c(1,0,0,0),
    xaxs = "i")
for(i in 1:4){
hist(as.vector(space[,"response_time",])[which(space[,"condition",]== i)],
     axes = FALSE, ann = FALSE, breaks = 50, 
     xlim = c(0,max(space[,"response_time",])))
  axis(1,pos = c(0,0))
}

```

Histogram of response times by condition, the blue bars represent the response times for correct responses. The densities seem to indicate that both correct and incorrect responses have the same response time distributions.

```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=2}
layout(t(seq(1,4)))
par(mai = c(0.1,0.1,0.1,0.1),
    oma = c(1,0,0,0),
    xaxs = "i")
for(i in 1:4){
  plot(density(as.vector(space[,"response_time",])[which(space[,"condition",]== i &
                                                         space[,"correct",] == 1)]),
     axes = FALSE, ann = FALSE, col = "blue", xlim = c(0,20))
  lines(density(as.vector(space[,"response_time",])[which(space[,"condition",] == i &
                                                          space[,"correct",] == 0)]),
     col = "red")
  axis(1,pos = c(0,0))
}

```

Plots are not that clear with all data accumulated, we can select some participants
to show and then analyze everyone. Two participants selected at random where 10 and 45.
the next figure shows the predicted positions by participant and condition.

```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=2}
selected <- c(10, 45)
layout(matrix(seq(1,8),nrow = 2,ncol = 4,byrow = TRUE))
par(mai = c(0.1,0.1,0.1,0.1),
    oma = c(1,0,0,0),
    xaxs = "i")
for(p in selected){
  for(i in 1:4){
    hist(space[which(space[, "condition", p]== i), "response", p],
         axes = FALSE, ann = FALSE, xlim = c(-2 * pi - 0.9, 2 * pi + 0.9))
      axis(1,at = c(0,pi/2,pi,3/2 * pi, 2*pi), 
           labels = c(0,expression(pi/2), expression(pi), 
                      expression(3*pi/2), expression(2*pi)),
           pos = c(0,0))
  }
}
```

The following plot shows the difference between prediction and the position of the spaceship by participant and condition.

```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=2}
selected <- c(10, 45)
layout(matrix(seq(1,8),nrow = 2,ncol = 4,byrow = TRUE))
par(mai = c(0.1,0.1,0.1,0.1),
    oma = c(1,0,0,0),
    xaxs = "i")
for(p in selected){
  for(i in 1:4){
    hist(space[which(space[, "condition", p]== i), "response", p] -
         space[which(space[, "condition", p]== i), "position", p],
         axes = FALSE, ann = FALSE, xlim = c(-2 * pi - 0.9, 2 * pi + 0.9),
         breaks = 30)
    axis(1, at = c(-2*pi, -pi/2, 0, pi/2, 2*pi), 
         labels = c(expression(-2*pi), expression(-pi/2), 0, 
                  expression( pi/2), expression( 2*pi)),
         pos = c(0,0))
  }
}
```

Histogram of response times by condition and participant.

```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=2}
selected <- c(10, 45)
layout(matrix(seq(1,8),nrow = 2,ncol = 4,byrow = TRUE))
par(mai = c(0.1,0.1,0.1,0.1),
    oma = c(1,0,0,0),
    xaxs = "i")
for(p in selected){
  for(i in 1:4){
    hist(space[which(space[, "condition", p]== i), "response_time", p],
         axes = FALSE, ann = FALSE,breaks = 50, 
         xlim = c(0,max(space[, "response_time", selected])))
    axis(1,pos = c(0,0))
  }
}
```

Density of response times by condition and participant conditional on a correct or 
incorrect response. Even by participant, response times don't seem to differ between
correct and incorrect responses (it's worth pointing out that the definition of 
a correct response is arbitrary).

```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=2}
selected <- c(10, 45)
layout(matrix(seq(1,8),nrow = 2,ncol = 4,byrow = TRUE))
par(mai = c(0.1,0.1,0.1,0.1),
    oma = c(1,0,0,0),
    xaxs = "i")
for(p in selected){
  for(i in 1:4){
    plot(density(space[which(space[, "condition", p] == i & 
                             space[, "correct", p] == 0), 
                       "response_time", p]),
         axes = FALSE, ann = FALSE,col = "red",
         xlim = c(0,max(space[, "response_time", selected])))
    
    lines(density(space[which(space[, "condition", p] == i & 
                              space[, "correct", p] == 1), 
                        "response_time", p]), col = "blue")
    axis(1,pos = c(0,0))
  }
}
```
